<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ğŸ„ Merry Christmas</title>
<style>
body {
    margin:0;
    background:radial-gradient(circle at top,#0a1a2f,#050b15);
    font-family:"Microsoft YaHei",sans-serif;
    color:#fff;
    text-align:center;
    overflow-x:hidden;
}
h1{margin:18px 0 6px; font-size:28px; color:gold; text-shadow:0 0 12px gold;}
p{margin:0 0 10px; opacity:.9;}

/* åœºæ™¯ */
#scene {
    position:relative;
    width:90%;
    max-width:360px;
    height:80vh;
    margin:20px auto;
    background:linear-gradient(#102840,#08131f);
    border-radius:22px;
    box-shadow:0 0 40px rgba(0,0,0,.6);
    overflow:hidden;
    padding: 15px; /* å››å‘¨ç•™ç™½ */
}

/* ç¥ç¦æ–‡å­— */
.greeting {
    position:absolute; 
    top:12px; 
    width:100%; 
    font-size:20px; 
    color:gold;
    text-shadow:0 0 6px gold,0 0 12px orange; 
    z-index:10;
}

/* æ ‘å®¹å™¨ - ä¿®æ”¹ï¼šæ·»åŠ å‚ç›´å±…ä¸­ */
.tree-wrapper {
    position: relative;
    width: 70%;
    height: calc(100% - 40px); /* å‡å»é¡¶éƒ¨å’Œåº•éƒ¨çš„ç©ºé—´ */
    margin: 40px auto 0; /* é¡¶éƒ¨ç•™å‡ºç©ºé—´ç»™æ˜Ÿæ˜Ÿ */
    display: flex;
    flex-direction: column;
    justify-content: space-between;
}

/* æ ‘å±‚ - ä¿®æ”¹ï¼šä½¿ç”¨ç›¸å¯¹å®šä½å’Œflexå¸ƒå±€ */
.tree-layer-container {
    position: relative;
    flex: 1;
    display: flex;
    flex-direction: column;
    justify-content: flex-end;
    align-items: center;
    height: 100%;
}

.tree-layer {
    position: relative;
    clip-path:polygon(50% 0,0 100%,100% 100%);
    border-radius:12px;
    box-shadow:inset 0 -14px 22px rgba(0,0,0,.28),0 6px 10px rgba(0,0,0,.25);
    margin-top: 5px; /* å±‚é—´è· */
}

.layer-top {
    width:50%; 
    height:25%; 
    background:radial-gradient(circle at top,#46f59c,#1e8f4e);
    z-index: 3;
}
.layer-mid {
    width:70%; 
    height:35%; 
    background:radial-gradient(circle at top,#35d481,#18753f);
    z-index: 2;
}
.layer-bottom {
    width:100%; 
    height:40%; 
    background:radial-gradient(circle at top,#2fb86a,#135e33);
    z-index: 1;
}

/* æ ‘å¹² - ä¿®æ”¹ï¼šåœ¨æ ‘å±‚å®¹å™¨å†…å®šä½ */
.trunk-container {
    position: relative;
    height: 12%;
    display: flex;
    justify-content: center;
    align-items: flex-start;
    margin-top: -8px; /* ç¨å¾®å‘ä¸Šç§»åŠ¨ä¸æ ‘é‡å  */
}

.trunk {
    width:16%;
    height:100%;
    background:linear-gradient(#8b5a2b,#5a3a1a);
    border-radius:6px;
    box-shadow:0 4px 8px rgba(0,0,0,.4);
}

/* æ˜Ÿæ˜Ÿ - ä¿®æ”¹ï¼šå®šä½åœ¨æ ‘ä¸Šæ–¹ */
.star {
    position: absolute;
    top: -35px; /* åœ¨æ ‘å®¹å™¨ä¸Šæ–¹ */
    left: 50%;
    transform: translateX(-50%);
    font-size: 38px;
    filter: drop-shadow(0 0 14px gold);
    animation: starPulse 1.6s infinite alternate;
    z-index: 5;
}
@keyframes starPulse {
    from{transform: translateX(-50%) scale(1); opacity:.8;}
    to{transform: translateX(-50%) scale(1.25); opacity:1;}
}

/* å½©ç¯ */
.light {
    position:absolute;
    width:4%;
    aspect-ratio:1/1;
    border-radius:50%;
    box-shadow:0 0 10px currentColor;
    animation:blink 1.3s infinite alternate;
}
@keyframes blink {from{opacity:.35} to{opacity:1;}}

/* è£…é¥°å·¥å…· */
#tools{margin-top:8px;}
.ornament{display:inline-block; font-size:28px; margin:6px; cursor:grab;}
.placed{position:absolute; cursor:grab; z-index:20;}

/* é›ªèŠ± */
.snowflake{position:fixed; top:-10px; color:white; pointer-events:none; z-index:1000; animation:fall linear;}
@keyframes fall{to{transform:translateY(110vh);}}

footer{font-size:12px; opacity:.7; margin:6px 0 10px;}
</style>
</head>
<body>

<h1>ğŸ„ Merry Christmas</h1>
<p>æŠŠè£…é¥°å“æ‹–åˆ°æ ‘ä¸Šå§ âœ¨</p>

<div id="scene">
    <div class="greeting">Merry Christmasï¼</div>
    
    <div class="tree-wrapper">
        <div class="star">â­</div>
        
        <div class="tree-layer-container">
            <div class="tree-layer layer-bottom"></div>
            <div class="tree-layer layer-mid"></div>
            <div class="tree-layer layer-top"></div>
            
            <!-- å½©ç¯å®¹å™¨ -->
            <div id="lights-container"></div>
        </div>
        
        <div class="trunk-container">
            <div class="trunk"></div>
        </div>
    </div>
</div>

<div id="tools">
    <span class="ornament">ğŸ</span>
    <span class="ornament">ğŸ””</span>
    <span class="ornament">ğŸ¬</span>
    <span class="ornament">ğŸ€</span>
    <span class="ornament">â„ï¸</span>
</div>

<footer>ğŸ¶ ç‚¹å‡»é¡µé¢æ’­æ”¾éŸ³ä¹ Â· â„ï¸ ä¸‹é›ªä¸­</footer>

<audio id="bgm" loop>
    <source src="music.mp3" type="audio/mpeg">
</audio>

<script>
const bgm=document.getElementById("bgm");
window.addEventListener("click",()=>{if(bgm.paused) bgm.play();});

/* æ‹–æ‹½å’Œè§¦æ§ */
let dragged=null;
function startDrag(e){e.preventDefault(); dragged=this.cloneNode(true); dragged.classList.add('placed'); document.body.appendChild(dragged); moveDrag(e);}
function moveDrag(e){ if(!dragged) return; let pageX=e.touches?e.touches[0].pageX:e.pageX; let pageY=e.touches?e.touches[0].pageY:e.pageY; dragged.style.left = pageX - dragged.offsetWidth/2 + 'px'; dragged.style.top = pageY - dragged.offsetHeight/2 + 'px';}
function endDrag(e){ if(!dragged) return; const scene=document.getElementById('scene'); const r=scene.getBoundingClientRect(); const x=parseInt(dragged.style.left); const y=parseInt(dragged.style.top); if(x>r.left&&x<r.right&&y>r.top&&y<r.bottom){dragged.style.left=(x-r.left)+'px'; dragged.style.top=(y-r.top)+'px'; scene.appendChild(dragged);} else dragged.remove(); dragged=null;}
document.querySelectorAll('.ornament').forEach(item=>{item.addEventListener('mousedown',startDrag); item.addEventListener('touchstart',startDrag);});
document.addEventListener('mousemove',moveDrag); document.addEventListener('touchmove',moveDrag);
document.addEventListener('mouseup',endDrag); document.addEventListener('touchend',endDrag);

/* ä¸‹é›ª */
function snow(){const s=document.createElement("div"); s.className="snowflake"; s.innerText="â„"; s.style.left=Math.random()*window.innerWidth+"px"; s.style.fontSize=(Math.random()*12+10)+"px"; s.style.animationDuration=(Math.random()*5+5)+"s"; document.body.appendChild(s); setTimeout(()=>s.remove(),10000);}
setInterval(snow,260);

/* èºæ—‹å½©ç¯ - ä¿®æ”¹ï¼šæ ¹æ®æ–°å¸ƒå±€è°ƒæ•´ */
function initLights() {
    const treeLayerContainer = document.querySelector('.tree-layer-container');
    const containerWidth = treeLayerContainer.offsetWidth;
    const containerHeight = treeLayerContainer.offsetHeight;
    const lightsContainer = document.getElementById('lights-container');
    
    // æ¸…é™¤æ—§å½©ç¯
    lightsContainer.innerHTML = '';
    
    // è®¡ç®—å„å±‚ä½ç½®
    const bottomLayer = document.querySelector('.layer-bottom');
    const midLayer = document.querySelector('.layer-mid');
    const topLayer = document.querySelector('.layer-top');
    
    // è·å–å„å±‚çš„å‚ç›´ä½ç½®ï¼ˆç›¸å¯¹äºå®¹å™¨ï¼‰
    const bottomRect = bottomLayer.getBoundingClientRect();
    const midRect = midLayer.getBoundingClientRect();
    const topRect = topLayer.getBoundingClientRect();
    const containerRect = treeLayerContainer.getBoundingClientRect();
    
    const bottomTop = bottomRect.top - containerRect.top;
    const bottomHeight = bottomRect.height;
    const midTop = midRect.top - containerRect.top;
    const midHeight = midRect.height;
    const topTop = topRect.top - containerRect.top;
    const topHeight = topRect.height;
    
    // æ·»åŠ å½©ç¯
    function addLights(y1, y2, amp, count) {
        for(let i = 0; i < count; i++) {
            const t = i / count;
            const y = y1 + t * (y2 - y1);
            const x = containerWidth/2 + Math.sin(t * Math.PI * 4) * amp;
            
            const light = document.createElement("div");
            light.className = "light";
            light.style.left = x + "px";
            light.style.top = y + "px";
            light.style.background = ["#ff4d4d", "#ffd84d", "#4de1ff", "#ff7be5"][i % 4];
            light.style.animationDelay = Math.random() + "s";
            lightsContainer.appendChild(light);
        }
    }
    
    // æ ¹æ®æ ‘å±‚ä½ç½®æ·»åŠ å½©ç¯
    addLights(bottomTop, bottomTop + bottomHeight, containerWidth * 0.4, 22);
    addLights(midTop, midTop + midHeight, containerWidth * 0.35, 18);
    addLights(topTop, topTop + topHeight, containerWidth * 0.25, 12);
}

// ç­‰å¾…DOMåŠ è½½å®Œæˆååˆå§‹åŒ–å½©ç¯
window.addEventListener('load', initLights);
// çª—å£å¤§å°æ”¹å˜æ—¶é‡æ–°åˆå§‹åŒ–å½©ç¯
window.addEventListener('resize', initLights);
</script>

</body>
</html>
